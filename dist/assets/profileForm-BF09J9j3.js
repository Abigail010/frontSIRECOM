import{y as X,a4 as Y,H as m,D as Z,a2 as R,E as ee,o as d,c as n,b as r,w as s,d as y,z as ae,s as v,F as u,x as V,k as w,a as f,t as S,V as le,a3 as te}from"./index-Dy25lhf-.js";import{u as oe}from"./profile-PX5hp9_e.js";import{u as re}from"./resource-D3r1mG67.js";import{v as ie}from"./validateText-UQqnbmko.js";import{B as de}from"./BaseBreadcrumb-C5UaFXUf.js";import{V as h,a as _}from"./VRow-ZO_qUyUR.js";import{V as se}from"./VLabel-qzXXXU03.js";import{V as ne}from"./VTextField-Bq6PBZui.js";import{V as T}from"./VContainer-BEhBydUt.js";import{V as C}from"./VCheckbox-D0T0OI6U.js";import{V as B}from"./VSwitch-B98sSIlG.js";import{V as j}from"./VBtn-C44RPYWD.js";import"./useRender-CfWTRdCe.js";import"./router-CC7bdr8J.js";import"./VCard-DS1E0FSC.js";import"./VAvatar-MXhgKYV7.js";import"./transition-CbZCXkoV.js";import"./VField-CDa7vy0m.js";import"./index-Bhvdqevn.js";import"./VInput-DwLyVZ1r.js";import"./forwardRefs-D3j0TLhE.js";import"./VCheckboxBtn-CTlTGIon.js";import"./VSelectionControl-BxnXJugj.js";import"./VProgressCircular-wIRUXPiR.js";import"./resizeObserver-B_oMf9XJ.js";import"./group-Dt4i2gXm.js";const ue=f("h4",{class:"mb-5 mt-2 font-weight-light"},[f("strong",null," DATOS DEL PERFIL:"),y(" Los campos con "),f("span",{style:{color:"red"}},"(*) "),y(" son obligatorios ")],-1),me=f("span",{style:{color:"red"}},"(*)",-1),ce={key:0,class:"v-messages font-weight-black px-2 py-2"},fe=f("div",{class:"v-messages__message text-error"}," El campo es requerido ",-1),pe=[fe],ve=f("h3",{class:"my-3 text-primary"},"Menu",-1),Ve={class:"my-3 text-primary"},he={class:"mb-5 text-primary"},_e={class:"my-3 text-info"},ye={key:0,class:"v-messages font-weight-black px-2 py-2 text-center"},De=f("div",{class:"v-messages__message text-error"}," Debe seleccionar al menos una opciÃ³n ",-1),be=[De],ke={class:"text-lg-left"},We=X({__name:"profileForm",setup(ge){const U=Y(),E=oe(),I=re(),D=m(!1),P=m(!0),q=m({title:"Perfil"}),z=m([{text:"Dashboard",disabled:!1,href:"#"},{text:"Perfil",disabled:!0,href:"#"}]),o=Z({formData:{id:"",nombre_perfil:"",estado:"",menu:[],ediciones:[]}}),A=m(!1),L=m([]),F=m([]),b=m([]),$=m([]),k=m([]),M=m([]),g=m([]),N=m([]),H=async()=>{L.value=await I.getMenu();const l=L.value;for(let e=0;e<l.length;e++)l[e].titulo&&l[e].direccion&&!l[e].padre&&F.value.push(l[e]),l[e].titulo&&!l[e].direccion&&!l[e].padre&&b.value.push(l[e]);for(let e=0;e<b.value.length;e++){const t=b.value[e];for(let a=0;a<l.length;a++)l[a].padre==t.id&&l[a].direccion&&$.value.push(l[a]),l[a].padre==t.id&&!l[a].direccion&&k.value.push(l[a])}for(let e=0;e<k.value.length;e++){const t=k.value[e];for(let a=0;a<l.length;a++)l[a].padre==t.id&&l[a].direccion&&M.value.push(l[a]),l[a].padre==t.id&&!l[a].direccion&&g.value.push(l[a])}for(let e=0;e<g.value.length;e++){const t=g.value[e];for(let a=0;a<l.length;a++)l[a].padre==t.id&&l[a].direccion&&N.value.push(l[a])}},O=async l=>{const e=await E.profile(l);o.formData.id=e.id,o.formData.nombre_perfil=e.nombre_perfil;for(let t=0;t<e.menus.length;t++)o.formData.menu.push(e.menus[t].id_menu),e.menus[t].editar&&o.formData.ediciones.push(e.menus[t].id_menu)},G=m([]),J=async()=>{P.value=!0,G.value=[],(!o.formData.nombre_perfil||o.formData.menu.length==0)&&(P.value=!1)},K=()=>{te.push({name:"profileList"})},Q=async()=>{if(D.value=!0,await J(),!P.value)return;const{ok:l,message:e}=U.params.id_perfil=="0"?await E.createProfile(o.formData):await E.updateProfile(o.formData),t=l?"success":"error";l?R.fire({icon:t,title:e,timer:1500,showConfirmButton:!1,timerProgressBar:!0}):(W.fire({icon:t,title:e}),D.value=!1)},p=l=>{const e=o.formData.menu.find(a=>a==l),t=o.formData.ediciones.find(a=>a==l);return!e&&t&&(o.formData.ediciones=o.formData.ediciones.filter(a=>a!=l)),!e},W=R.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:2e3,timerProgressBar:!0});return ee(async()=>{await H(),U.params.id_perfil!="0"&&(await O(U.params.id_perfil),A.value=!0)}),(l,e)=>(d(),n(u,null,[r(de,{title:q.value.title,breadcrumbs:z.value},null,8,["title","breadcrumbs"]),r(_,null,{default:s(()=>[r(h,{cols:"12",lg:"12"},{default:s(()=>[ue,r(_,null,{default:s(()=>[r(h,{cols:"12",md:"12"},{default:s(()=>[r(se,{class:"mb-2 font-weight-medium"},{default:s(()=>[y("Nombre perfil "),me]),_:1}),r(ne,{variant:"outlined",color:"primary",type:"text","hide-details":"",modelValue:o.formData.nombre_perfil,"onUpdate:modelValue":e[0]||(e[0]=t=>o.formData.nombre_perfil=t),modelModifiers:{trim:!0},onInput:e[1]||(e[1]=t=>o.formData.nombre_perfil=ae(ie)(o.formData.nombre_perfil.toUpperCase()))},null,8,["modelValue"]),D.value&&!o.formData.nombre_perfil?(d(),n("div",ce,pe)):v("",!0)]),_:1})]),_:1}),r(_,null,{default:s(()=>[r(h,{cols:"12",md:"12",class:"mb-5"},{default:s(()=>[ve,r(T,{fluid:""},{default:s(()=>[r(_,null,{default:s(()=>[(d(!0),n(u,null,V(F.value,(t,a)=>(d(),w(h,{key:t.id,cols:"12",md:"4",class:"low-col"},{default:s(()=>[r(C,{modelValue:o.formData.menu,"onUpdate:modelValue":i=>o.formData.menu=i,label:t.titulo,color:"error",value:t.id,"hide-details":"",onClick:i=>p(t.id)},null,8,["modelValue","onUpdate:modelValue","label","value","onClick"]),r(B,{class:"pl-3 my-0",modelValue:o.formData.ediciones,"onUpdate:modelValue":e[2]||(e[2]=i=>o.formData.ediciones=i),label:"Editar",color:"secondary",value:t.id,"hide-details":"",disabled:p(t.id)},null,8,["modelValue","value","disabled"])]),_:2},1024))),128))]),_:1})]),_:1}),(d(!0),n(u,null,V(b.value,t=>(d(),n(u,{key:t.id},[f("h3",Ve,S(t.titulo),1),r(T,{fluid:""},{default:s(()=>[r(_,null,{default:s(()=>[(d(!0),n(u,null,V($.value,a=>(d(),n(u,{key:a.id},[t.id==a.padre?(d(),w(h,{key:0,cols:"12",md:"4",class:"low-col"},{default:s(()=>[r(C,{modelValue:o.formData.menu,"onUpdate:modelValue":i=>o.formData.menu=i,label:a.titulo,color:"error",value:a.id,"hide-details":"",onClick:i=>p(a.id)},null,8,["modelValue","onUpdate:modelValue","label","value","onClick"]),r(B,{class:"pl-3 my-0",modelValue:o.formData.ediciones,"onUpdate:modelValue":e[3]||(e[3]=i=>o.formData.ediciones=i),label:"Editar",color:"secondary",value:a.id,"hide-details":"",disabled:p(a.id)},null,8,["modelValue","value","disabled"])]),_:2},1024)):v("",!0)],64))),128))]),_:2},1024),(d(!0),n(u,null,V(k.value,a=>(d(),n(u,{key:a.id},[t.id==a.padre?(d(),n(u,{key:0},[f("h3",he,S(a.titulo),1),r(_,null,{default:s(()=>[(d(!0),n(u,null,V(M.value,i=>(d(),n(u,{key:i.id},[a.id==i.padre?(d(),w(h,{key:0,cols:"12",md:"4",class:"low-col"},{default:s(()=>[r(C,{modelValue:o.formData.menu,"onUpdate:modelValue":c=>o.formData.menu=c,label:i.titulo,color:"error",value:i.id,"hide-details":"",onClick:c=>p(i.id)},null,8,["modelValue","onUpdate:modelValue","label","value","onClick"]),r(B,{class:"pl-3 my-0",modelValue:o.formData.ediciones,"onUpdate:modelValue":e[4]||(e[4]=c=>o.formData.ediciones=c),label:"Editar",color:"secondary",value:i.id,"hide-details":"",disabled:p(i.id)},null,8,["modelValue","value","disabled"])]),_:2},1024)):v("",!0)],64))),128))]),_:2},1024),(d(!0),n(u,null,V(g.value,i=>(d(),n(u,{key:i.id},[a.id==i.padre?(d(),n(u,{key:0},[f("h3",_e,"- "+S(i.titulo),1),r(_,null,{default:s(()=>[(d(!0),n(u,null,V(N.value,c=>(d(),n(u,{key:c.id},[i.id==c.padre?(d(),w(h,{key:0,cols:"12",md:"4",class:"low-col"},{default:s(()=>[r(C,{modelValue:o.formData.menu,"onUpdate:modelValue":x=>o.formData.menu=x,label:c.titulo,color:"error",value:c.id,"hide-details":"",onClick:x=>p(c.id)},null,8,["modelValue","onUpdate:modelValue","label","value","onClick"]),r(B,{class:"pl-3 my-0",modelValue:o.formData.ediciones,"onUpdate:modelValue":e[5]||(e[5]=x=>o.formData.ediciones=x),label:"Editar",color:"secondary",value:c.id,"hide-details":"",disabled:p(c.id)},null,8,["modelValue","value","disabled"])]),_:2},1024)):v("",!0)],64))),128))]),_:2},1024)],64)):v("",!0)],64))),128))],64)):v("",!0)],64))),128))]),_:2},1024)],64))),128)),D.value&&o.formData.menu.length==0?(d(),n("div",ye,be)):v("",!0)]),_:1})]),_:1}),f("p",ke,[r(j,{color:"error",class:"mr-3",onClick:e[6]||(e[6]=t=>K())},{default:s(()=>[y("Cancelar")]),_:1}),r(j,{color:"primary",onClick:e[7]||(e[7]=le(t=>Q(),["prevent"]))},{default:s(()=>[y("Enviar")]),_:1})])]),_:1})]),_:1})],64))}});export{We as default};
