import{y as pe,a4 as _e,H as f,D as ve,a2 as ee,E as De,o as d,c as s,b as t,w as i,d as _,z as c,s as D,k as E,F as v,x as k,a as n,t as J,V as Ve,a3 as ge}from"./index-CszBAM03.js";import{B as ye}from"./BaseBreadcrumb-DwdMcImx.js";import{u as be}from"./resource-gnRvB98_.js";import{u as he}from"./user-DQ88wOj9.js";import{v as w}from"./validateText-UQqnbmko.js";import{u as we}from"./fuerza-DIWKmFA9.js";import{V as m,a as U}from"./VRow-DBcpD8Qp.js";import{V}from"./VLabel-BtCFtaTj.js";import{V as y}from"./VTextField-9IO55YPG.js";import{V as A}from"./VSelect-_3e7L0gA.js";import{V as ae}from"./VContainer-BXlBqOco.js";import{V as F}from"./VCheckbox-xVVbbiEb.js";import{V as L}from"./VSwitch-FuFTPHZJ.js";import{V as oe}from"./VBtn-Dq3bGSJl.js";import"./useRender-DOYTO3KG.js";import"./router-DFOTdtPw.js";import"./VCard-BTpief3e.js";import"./VAvatar-BKZImlRa.js";import"./transition-W-nos0ap.js";import"./VField-C-F8V5sK.js";import"./index-LAUdzUTV.js";import"./VInput-0KAS55SC.js";import"./forwardRefs-D3j0TLhE.js";import"./VList-C33xlGF1.js";import"./ssrBoot-BElN-gkj.js";import"./VDivider-vSm4-OLf.js";import"./dialog-transition-3tsliuNe.js";import"./VMenu-D4LASOd-.js";import"./VOverlay-B4mnRK_2.js";import"./lazy-Bzbiuov3.js";import"./scopeId-8SGJqsHn.js";import"./resizeObserver-CUpPeGSI.js";import"./VCheckboxBtn-8utVmdr7.js";import"./VSelectionControl-Bj0429w5.js";import"./VChip-O0CpkqDE.js";import"./VSlideGroup-DarFEWBw.js";import"./group-CRVrfb2c.js";import"./VProgressCircular-D3_p53Ys.js";const ke=n("h4",{class:"mb-5 mt-2 font-weight-light"},[n("strong",null," DATOS DEL USUARIO:"),_(" Los campos con "),n("span",{style:{color:"red"}},"(*)"),_(" son obligatorios ")],-1),Ue=n("span",{style:{color:"red"}},"(*)",-1),xe={key:0,class:"v-messages font-weight-black px-2 py-2"},Ce=n("div",{class:"v-messages__message text-error"}," El campo es requerido ",-1),Se=[Ce],Ie=n("span",{style:{color:"red"}},"(*)",-1),Be={key:0,class:"v-messages font-weight-black px-2 py-2"},Ee=n("div",{class:"v-messages__message text-error"}," El campo es requerido ",-1),Me=[Ee],$e=n("span",{style:{color:"red"}},"(*)",-1),ze={key:0,class:"v-messages font-weight-black px-2 py-2"},Ne=n("div",{class:"v-messages__message text-error"}," El campo es requerido ",-1),Pe=[Ne],qe=n("span",{style:{color:"red"}},"(*)",-1),Fe={key:0,class:"v-messages font-weight-black px-2 py-2"},Le=n("div",{class:"v-messages__message text-error"}," El campo es requerido ",-1),Re=[Le],Te=n("span",{style:{color:"red"}},"(*)",-1),Oe={key:0,class:"v-messages font-weight-black px-2 py-2"},Je=n("div",{class:"v-messages__message text-error"}," Debe ser un correo válido ",-1),Ae=[Je],je=n("span",{style:{color:"red"}},"(*)",-1),He={key:0,class:"v-messages font-weight-black px-2 py-2"},Ge=n("div",{class:"v-messages__message text-error"}," El campo es requerido ",-1),Ke=[Ge],Qe=n("span",{style:{color:"red"}},"(*)",-1),We={key:0,class:"v-messages font-weight-black px-2 py-2"},Xe=n("div",{class:"v-messages__message text-error"}," El campo es requerido ",-1),Ye=[Xe],Ze=n("span",{style:{color:"red"}},"(*)",-1),ea=n("h3",{class:"my-3 text-primary"},"Menu",-1),aa={class:"my-3 text-primary"},oa={class:"mb-5 text-primary"},ta={class:"my-3 text-info"},la={class:"text-lg-left"},Aa=pe({__name:"userForm",setup(ra){const te=we();JSON.parse(localStorage.getItem("user")||"").nombre_perfil,JSON.parse(localStorage.getItem("user")||"").cedula_identidad;const R=_e(),C=be(),S=he(),le=f({title:"Usuario"}),re=f([{text:"Dashboard",disabled:!1,href:"#"},{text:"Usuario",disabled:!0,href:"#"}]),e=ve({formData:{id_persona:"",id_usuario:"",id_perfil:null,id_taller:null,id_fuerza:null,cedula_identidad:"",complemento:"",nombres:"",apellido_paterno:"",apellido_materno:"",genero:"",fecha_nacimiento:"",pais:"",departamento:"",provincia:"",localidad:"",domicilio:"",imagen:"",nombre_usuario:"",contrasena:"",correo_electronico:"",celular:"",menu:[],ediciones:[]}}),j=f([]),H=f(!1),G=JSON.parse(localStorage.getItem("user")||"").id_perfil,K=JSON.parse(localStorage.getItem("user")||"").id_taller,M=f([]),ie=async()=>{M.value=await C.getProfiles(),G==1||K==1?M.value=await C.getProfiles():M.value=await S.Perfil()},T=f([]),de=async()=>{G==1||K==1?T.value=await C.getTalleres():T.value=await S.Taller(),j.value=await te.fuerza()},I=JSON.parse(localStorage.getItem("user")||"").id_perfil,B=JSON.parse(localStorage.getItem("user")||"").id_taller,Q=f([]),W=f([]),$=f([]),X=f([]),z=f([]),Y=f([]),N=f([]),Z=f([]),se=async()=>{Q.value=await C.getMenu();const r=Q.value;for(let a=0;a<r.length;a++)r[a].titulo&&r[a].direccion&&!r[a].padre&&(r[a].titulo=="Busqueda Reporte",W.value.push(r[a])),r[a].titulo&&!r[a].direccion&&!r[a].padre&&$.value.push(r[a]);for(let a=0;a<$.value.length;a++){const o=$.value[a];for(let l=0;l<r.length;l++)r[l].padre==o.id&&r[l].direccion&&X.value.push(r[l]),r[l].padre==o.id&&!r[l].direccion&&z.value.push(r[l])}for(let a=0;a<z.value.length;a++){const o=z.value[a];for(let l=0;l<r.length;l++)r[l].padre==o.id&&r[l].direccion&&Y.value.push(r[l]),r[l].padre==o.id&&!r[l].direccion&&N.value.push(r[l])}for(let a=0;a<N.value.length;a++){const o=N.value[a];for(let l=0;l<r.length;l++)r[l].padre==o.id&&r[l].direccion&&Z.value.push(r[l])}},x=f([]),ne=async()=>{x.value=await C.getProfileMenu()},me=async()=>{e.formData.menu=[];for(let r=0;r<x.value.length;r++)x.value[r].id_perfil==e.formData.id_perfil&&(e.formData.menu.push(x.value[r].id_menu),x.value[r].editar&&e.formData.ediciones.push(x.value[r].id_menu))},ue=async r=>{const a=await S.user(r);e.formData.id_usuario=a.id,e.formData.id_persona=a.id_persona,e.formData.id_taller=a.id_taller,e.formData.id_fuerza=a.id_fuerza,e.formData.id_perfil=a.id_perfil,e.formData.cedula_identidad=a.cedula_identidad,e.formData.nombres=a.nombres,e.formData.apellido_paterno=a.apellido_paterno,e.formData.apellido_materno=a.apellido_materno,e.formData.fecha_nacimiento=a.fecha_nacimiento,e.formData.correo_electronico=a.correo_electronico,e.formData.celular=a.celular,e.formData.nombre_usuario=a.nombre_usuario,e.formData.contrasena=a.contrasena;const o=a.menu;for(let l=0;l<o.length;l++)e.formData.menu.push(o[l].id_menu),o[l].editar&&e.formData.ediciones.push(o[l].id_menu)},P=f(!0),O=f(!0),b=async()=>{P.value=!0,O.value=!0,(!e.formData.cedula_identidad||!e.formData.nombres||!e.formData.nombre_usuario||!e.formData.contrasena||!e.formData.correo_electronico||!e.formData.id_taller||!e.formData.id_perfil||!e.formData.apellido_materno&&!e.formData.apellido_paterno)&&(P.value=!1);const r=/^\w+([.-_+]?\w+)*@\w+([.-]?\w+)*(\.\w{2,10})+$/;e.formData.correo_electronico&&!r.test(e.formData.correo_electronico)&&(O.value=!1,P.value=!1)},fe=()=>{ge.push({name:"userList"})},u=f(!1),ce=async()=>{if(u.value=!0,await b(),!P.value)return;const{ok:r,message:a}=R.params.id_usuario=="0"?await S.createUser(e.formData):await S.updateUser(e.formData),o=r?"success":"error";ee.fire({icon:o,title:a,timer:1500,showConfirmButton:!1,timerProgressBar:!0})},h=r=>{const a=e.formData.menu.find(l=>l==r),o=e.formData.ediciones.find(l=>l==r);return!a&&o&&(e.formData.ediciones=e.formData.ediciones.filter(l=>l!=r)),!a};return ee.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:2e3,timerProgressBar:!0}),De(async()=>{await ie(),await de(),await se(),await ne(),R.params.id_usuario!="0"&&(await ue(R.params.id_usuario),H.value=!0)}),(r,a)=>(d(),s(v,null,[t(ye,{title:le.value.title,breadcrumbs:re.value},null,8,["title","breadcrumbs"]),t(U,null,{default:i(()=>[t(m,{cols:"12",lg:"12"},{default:i(()=>[ke,t(U,null,{default:i(()=>[t(m,{cols:"12",md:"4"},{default:i(()=>[t(V,{class:"mb-2 font-weight-medium"},{default:i(()=>[_(" Cedula de Identidad"),Ue]),_:1}),t(y,{variant:"outlined",color:"primary",type:"text",modelValue:e.formData.cedula_identidad,"onUpdate:modelValue":a[0]||(a[0]=o=>e.formData.cedula_identidad=o),modelModifiers:{trim:!0},onInput:a[1]||(a[1]=o=>(b(),e.formData.cedula_identidad=c(w)(e.formData.cedula_identidad.toUpperCase()))),error:u.value&&!e.formData.cedula_identidad,"hide-details":""},null,8,["modelValue","error"]),u.value&&!e.formData.cedula_identidad?(d(),s("div",xe,Se)):D("",!0)]),_:1}),t(m,{cols:"12",md:"4"},{default:i(()=>[t(V,{class:"mb-2 font-weight-medium"},{default:i(()=>[_("Complemento")]),_:1}),t(y,{variant:"outlined",color:"primary",modelValue:e.formData.complemento,"onUpdate:modelValue":a[2]||(a[2]=o=>e.formData.complemento=o),modelModifiers:{trim:!0},onInput:a[3]||(a[3]=o=>e.formData.complemento=c(w)(e.formData.complemento.toUpperCase())),readonly:H.value},null,8,["modelValue","readonly"])]),_:1}),t(m,{cols:"12",md:"4"},{default:i(()=>[t(V,{class:"mb-2 font-weight-medium"},{default:i(()=>[_("Nombres"),Ie]),_:1}),t(y,{variant:"outlined",color:"primary",type:"text",modelValue:e.formData.nombres,"onUpdate:modelValue":a[4]||(a[4]=o=>e.formData.nombres=o),modelModifiers:{trim:!0},onInput:a[5]||(a[5]=o=>(b(),e.formData.nombres=c(w)(e.formData.nombres.toUpperCase()))),error:u.value&&!e.formData.nombres,"hide-details":""},null,8,["modelValue","error"]),u.value&&!e.formData.nombres?(d(),s("div",Be,Me)):D("",!0)]),_:1}),t(m,{cols:"12",md:"4"},{default:i(()=>[t(V,{class:"mb-2 font-weight-medium"},{default:i(()=>[_("Apellido Paterno")]),_:1}),t(y,{variant:"outlined",color:"primary",type:"text",modelValue:e.formData.apellido_paterno,"onUpdate:modelValue":a[6]||(a[6]=o=>e.formData.apellido_paterno=o),onInput:a[7]||(a[7]=o=>(b(),e.formData.apellido_paterno=c(w)(e.formData.apellido_paterno.toUpperCase()))),error:u.value&&!e.formData.apellido_materno},null,8,["modelValue","error"])]),_:1}),t(m,{cols:"12",md:"4"},{default:i(()=>[t(V,{class:"mb-2 font-weight-medium"},{default:i(()=>[_("Apellido Materno")]),_:1}),t(y,{variant:"outlined",color:"primary",type:"text",modelValue:e.formData.apellido_materno,"onUpdate:modelValue":a[8]||(a[8]=o=>e.formData.apellido_materno=o),onInput:a[9]||(a[9]=o=>(b(),e.formData.apellido_materno=c(w)(e.formData.apellido_materno.toUpperCase()))),error:u.value&&!e.formData.apellido_materno},null,8,["modelValue","error"])]),_:1}),t(m,{cols:"12",md:"4"},{default:i(()=>[t(V,{class:"mb-2 font-weight-medium"},{default:i(()=>[_("Fecha nacimiento")]),_:1}),t(y,{variant:"outlined",color:"primary",type:"date",modelValue:e.formData.fecha_nacimiento,"onUpdate:modelValue":a[10]||(a[10]=o=>e.formData.fecha_nacimiento=o),modelModifiers:{trim:!0},onInput:a[11]||(a[11]=o=>(b(),e.formData.fecha_nacimiento=c(w)(e.formData.fecha_nacimiento.toUpperCase()))),"hide-details":""},null,8,["modelValue"])]),_:1}),t(m,{cols:"12",md:"4"},{default:i(()=>[t(V,{class:"mb-2 font-weight-medium"},{default:i(()=>[_("Nombre de usuario"),$e]),_:1}),t(y,{variant:"outlined",color:"primary",type:"text",modelValue:e.formData.nombre_usuario,"onUpdate:modelValue":a[12]||(a[12]=o=>e.formData.nombre_usuario=o),modelModifiers:{trim:!0},onInput:a[13]||(a[13]=o=>(b(),e.formData.nombre_usuario=c(w)(e.formData.nombre_usuario.toUpperCase()))),error:u.value&&!e.formData.nombre_usuario,"hide-details":""},null,8,["modelValue","error"]),u.value&&!e.formData.nombre_usuario?(d(),s("div",ze,Pe)):D("",!0)]),_:1}),t(m,{cols:"12",md:"4"},{default:i(()=>[t(V,{class:"mb-2 font-weight-medium"},{default:i(()=>[_("Contraseña"),qe]),_:1}),t(y,{variant:"outlined",color:"primary",type:"password",modelValue:e.formData.contrasena,"onUpdate:modelValue":a[14]||(a[14]=o=>e.formData.contrasena=o),modelModifiers:{trim:!0},onInput:a[15]||(a[15]=o=>(b(),e.formData.contrasena)),error:u.value&&!e.formData.contrasena,"hide-details":""},null,8,["modelValue","error"]),u.value&&!e.formData.contrasena?(d(),s("div",Fe,Re)):D("",!0)]),_:1}),t(m,{cols:"12",md:"4"},{default:i(()=>[t(V,{class:"mb-2 font-weight-medium"},{default:i(()=>[_("Correo electrónico"),Te]),_:1}),t(y,{variant:"outlined",color:"primary",type:"email",modelValue:e.formData.correo_electronico,"onUpdate:modelValue":a[16]||(a[16]=o=>e.formData.correo_electronico=o),modelModifiers:{trim:!0},onInput:a[17]||(a[17]=o=>(b(),e.formData.correo_electronico=c(w)(e.formData.correo_electronico))),error:u.value&&!e.formData.correo_electronico,"hide-details":""},null,8,["modelValue","error"]),u.value&&e.formData.correo_electronico&&!O.value?(d(),s("div",Oe,Ae)):D("",!0)]),_:1}),t(m,{cols:"12",md:"4"},{default:i(()=>[t(V,{class:"mb-2 font-weight-medium"},{default:i(()=>[_("Celular")]),_:1}),t(y,{variant:"outlined",color:"primary",type:"number",modelValue:e.formData.celular,"onUpdate:modelValue":a[18]||(a[18]=o=>e.formData.celular=o)},null,8,["modelValue"])]),_:1}),t(m,{cols:"12",md:"4"},{default:i(()=>[t(V,{class:"mb-2 font-weight-medium"},{default:i(()=>[_("Taller"),je]),_:1}),t(A,{items:T.value,"item-title":"nombre_taller","item-value":"id",modelValue:e.formData.id_taller,"onUpdate:modelValue":a[19]||(a[19]=o=>e.formData.id_taller=o),error:u.value&&!e.formData.id_taller},null,8,["items","modelValue","error"]),u.value&&!e.formData.id_taller?(d(),s("div",He,Ke)):D("",!0)]),_:1}),t(m,{cols:"12",md:"4"},{default:i(()=>[t(V,{class:"mb-2 font-weight-medium"},{default:i(()=>[_("Rol"),Qe]),_:1}),t(A,{items:M.value,"item-title":"nombre_perfil","item-value":"id",modelValue:e.formData.id_perfil,"onUpdate:modelValue":[a[20]||(a[20]=o=>e.formData.id_perfil=o),a[21]||(a[21]=o=>me())],error:u.value&&!e.formData.id_perfil},null,8,["items","modelValue","error"]),u.value&&!e.formData.id_perfil?(d(),s("div",We,Ye)):D("",!0)]),_:1}),e.formData.id_perfil!=""&&e.formData.id_perfil=="5"?(d(),E(m,{key:0,cols:"12",md:"4"},{default:i(()=>[t(V,{class:"mb-2 font-weight-medium"},{default:i(()=>[_("Fuerza"),Ze]),_:1}),t(A,{items:j.value,"item-title":"nombre_fuerza","item-value":"id_fuerza",modelValue:e.formData.id_fuerza,"onUpdate:modelValue":a[22]||(a[22]=o=>e.formData.id_fuerza=o),error:u.value&&!e.formData.id_fuerza},null,8,["items","modelValue","error"])]),_:1})):D("",!0)]),_:1}),t(U,null,{default:i(()=>[t(m,{cols:"12",md:"12",class:"mb-5"},{default:i(()=>[ea,t(ae,{fluid:""},{default:i(()=>[t(U,null,{default:i(()=>[(d(!0),s(v,null,k(W.value,o=>(d(),E(m,{key:o.id,cols:"12",md:"4",class:"low-col"},{default:i(()=>[t(F,{modelValue:e.formData.menu,"onUpdate:modelValue":l=>e.formData.menu=l,label:o.titulo,color:"error",value:o.id,"hide-details":"",onClick:l=>h(o.id),disabled:(o.titulo=="Talleres"||o.titulo=="Busqueda Reporte")&&!(c(I)==1||c(B)==1)},null,8,["modelValue","onUpdate:modelValue","label","value","onClick","disabled"]),t(L,{class:"pl-3 my-0",modelValue:e.formData.ediciones,"onUpdate:modelValue":a[23]||(a[23]=l=>e.formData.ediciones=l),label:"Editar",color:"secondary",value:o.id,"hide-details":"",disabled:h(o.id)||(o.titulo=="Talleres"||o.titulo=="Busqueda Reporte")&&!(c(I)==1||c(B)==1)},null,8,["modelValue","value","disabled"])]),_:2},1024))),128))]),_:1})]),_:1}),(d(!0),s(v,null,k($.value,o=>(d(),s(v,{key:o.id},[n("h3",aa,J(o.titulo),1),t(ae,{fluid:""},{default:i(()=>[t(U,null,{default:i(()=>[(d(!0),s(v,null,k(X.value,l=>(d(),s(v,{key:l.id},[o.id==l.padre?(d(),E(m,{key:0,cols:"12",md:"4",class:"low-col"},{default:i(()=>[t(F,{modelValue:e.formData.menu,"onUpdate:modelValue":p=>e.formData.menu=p,label:l.titulo,color:"error",value:l.id,"hide-details":"",onClick:p=>h(l.id),disabled:(l.titulo=="Perfil"||l.titulo=="Servicios")&&!(c(I)==1||c(B)==1)},null,8,["modelValue","onUpdate:modelValue","label","value","onClick","disabled"]),t(L,{class:"pl-3 my-0",modelValue:e.formData.ediciones,"onUpdate:modelValue":a[24]||(a[24]=p=>e.formData.ediciones=p),label:"Editar",color:"secondary",value:l.id,"hide-details":"",disabled:h(l.id)||(l.titulo=="Perfil"||l.titulo=="Servicios")&&!(c(I)==1||c(B)==1)},null,8,["modelValue","value","disabled"])]),_:2},1024)):D("",!0)],64))),128))]),_:2},1024),c(I)==1||c(B)==1?(d(!0),s(v,{key:0},k(z.value,l=>(d(),s(v,{key:l.id},[o.id==l.padre?(d(),s(v,{key:0},[n("h3",oa,J(l.titulo),1),t(U,null,{default:i(()=>[(d(!0),s(v,null,k(Y.value,p=>(d(),s(v,{key:p.id},[l.id==p.padre?(d(),E(m,{key:0,cols:"12",md:"4",class:"low-col"},{default:i(()=>[t(F,{modelValue:e.formData.menu,"onUpdate:modelValue":g=>e.formData.menu=g,label:p.titulo,color:"error",value:p.id,"hide-details":"",onClick:g=>h(p.id)},null,8,["modelValue","onUpdate:modelValue","label","value","onClick"]),t(L,{class:"pl-3 my-0",modelValue:e.formData.ediciones,"onUpdate:modelValue":a[25]||(a[25]=g=>e.formData.ediciones=g),label:"Editar",color:"secondary",value:p.id,"hide-details":"",disabled:h(p.id)},null,8,["modelValue","value","disabled"])]),_:2},1024)):D("",!0)],64))),128))]),_:2},1024),(d(!0),s(v,null,k(N.value,p=>(d(),s(v,{key:p.id},[l.id==p.padre?(d(),s(v,{key:0},[n("h3",ta,"- "+J(p.titulo),1),t(U,null,{default:i(()=>[(d(!0),s(v,null,k(Z.value,g=>(d(),s(v,{key:g.id},[p.id==g.padre?(d(),E(m,{key:0,cols:"12",md:"4",class:"low-col"},{default:i(()=>[t(F,{modelValue:e.formData.menu,"onUpdate:modelValue":q=>e.formData.menu=q,label:g.titulo,color:"error",value:g.id,"hide-details":"",onClick:q=>h(g.id)},null,8,["modelValue","onUpdate:modelValue","label","value","onClick"]),t(L,{class:"pl-3 my-0",modelValue:e.formData.ediciones,"onUpdate:modelValue":a[26]||(a[26]=q=>e.formData.ediciones=q),label:"Editar",color:"secondary",value:g.id,"hide-details":"",disabled:h(g.id)},null,8,["modelValue","value","disabled"])]),_:2},1024)):D("",!0)],64))),128))]),_:2},1024)],64)):D("",!0)],64))),128))],64)):D("",!0)],64))),128)):D("",!0)]),_:2},1024)],64))),128))]),_:1})]),_:1}),n("p",la,[t(oe,{color:"error",class:"mr-3",onClick:a[27]||(a[27]=o=>fe())},{default:i(()=>[_("Cancelar")]),_:1}),t(oe,{color:"primary",onClick:a[28]||(a[28]=Ve(o=>ce(),["prevent"]))},{default:i(()=>[_("Enviar")]),_:1})])]),_:1})]),_:1})],64))}});export{Aa as default};
